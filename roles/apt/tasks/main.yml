- block:
# name: Setting up apt repositories for Debian

  - name: Add apt-transport-https package
    apt:
      name: apt-transport-https
      state: present
      update_cache: no
    when:
      - "ansible_os_family == 'Debian'"

  - name: Add official apt sources.list (https)
    apt_repository:
      repo: '{{ item }}'
      state: present
      filename: official-sources
    with_items:
      - 'deb https://deb.debian.org/debian stretch main contrib non-free'
      - 'deb-src https://deb.debian.org/debian stretch main contrib non-free'
      - 'deb https://deb.debian.org/debian stretch-updates main contrib non-free'
      - 'deb-src https://deb.debian.org/debian stretch-updates main contrib non-free'
      - 'deb https://security.debian.org/debian-security/ stretch/updates main contrib non-free'
      - 'deb-src https://security.debian.org/debian-security/ stretch/updates main contrib non-free'

  - name: Update apt cache only once in 1h
    apt:
      update_cache: yes
      cache_valid_time: 3600
    when:
      - "ansible_os_family == 'Debian'"

  become: true
